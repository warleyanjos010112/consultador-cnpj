name: Build Windows Executable

# Permite que o fluxo de trabalho seja iniciado manualmente na aba "Actions"
on:
  workflow_dispatch:

jobs:
  build:
    # Usa a versão mais recente do Windows fornecida pelo GitHub
    runs-on: windows-latest

    steps:
      # 1. Baixa o seu código do repositório para a máquina virtual
      - name: Check out repository
        uses: actions/checkout@v4 # Usando uma versão mais recente do checkout também

      # 2. Configura o ambiente Python
      - name: Set up Python
        uses: actions/setup-python@v5 # Usando uma versão mais recente do setup-python
        with:
          python-version: '3.11'

      # 3. Instala as bibliotecas necessárias (dependências)
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install pandas requests openpyxl pyinstaller

      # 4. Executa o PyInstaller para criar o .exe
      - name: Build executable with PyInstaller
        run: |
          # IMPORTANTE: Verifique se "script_final.py" é o nome exato do seu arquivo .py no repositório
          python -m pyinstaller --onefile --name "ConsultadorCNPJ" "script_final.py"

      # 5. Faz o upload do .exe gerado como um "artefato" para download
      - name: Upload artifact
        uses: actions/upload-artifact@v4 # <-- ESTA É A LINHA QUE CORRIGIMOS
        with:
          name: ConsultadorCNPJ-Windows
          path: dist/ConsultadorCNPJ.exe
